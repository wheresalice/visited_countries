{{ define "main" }}
      {{ $regions := apply $.Site.Data.countries "index" "." "region"| uniq}}
      {{ $visitedCount := where $.Site.Data.countries ".visited" "gt" 0 | len}}
      <header>
        <nav>
          <ul>
            {{ range $regions }}
            <li><a href="#{{.}}">{{.}}</a></li>
            {{ end }}
          </ul>
        </nav>
      </header>
    <main>
      <section>
        <table>
            <tr>
              <td>visited countries</td><td>{{ $visitedCount}}</td>
            </tr>
            <tr>
              <td>countries left for provisional <abbr title="Travelers Century Club">TCC</abbr> membership</td><td>{{ sub 75 $visitedCount}}</td>
            </tr>
            <tr>
              <td>countries left for full <abbr title="Travelers Century Club">TCC</abbr> membership</td><td>{{ sub 100 $visitedCount}}</td>
            </tr>
            <tr>
              <td>percentage visited</td><td>{{ mul (div (float $visitedCount) ($.Site.Data.countries | len)) 100 | printf "%18.1f"}}</td>
            </tr>
        </table>
      </section>
      {{ range $regions }}
      <h2><a id="{{ . }}">{{ . }}</a></h2>
      <ul>
        {{ range where $.Site.Data.countries ".region" .}}
          {{ $nameSlug := urlize .name}}
          {{ $countryIcon := "‚ùå"}}
          {{ if eq .visited 0.5 }}
            {{ $countryIcon = "‚úàÔ∏è"}}
          {{ else if eq .visited 1 }}
            {{ $countryIcon = "‚úÖ"}}
          {{ end }}
          {{ printf "<!-- %s.md -->" $nameSlug | safeHTML}}
          <li>{{ $countryIcon}} {{ .name }} {{ if os.FileExists (printf "country/%s.md" $nameSlug) }}<a href="{{ printf "/country/%s" $nameSlug}}">üîó</a>{{ end }}</li> 
        {{ end }}
      </ul>
      {{ end }}
    </main>
{{ end }}
